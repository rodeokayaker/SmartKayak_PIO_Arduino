# –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –≤–µ—Å–ª–∞ (Paddle Orientation Fusion)

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –≤–µ—Å–ª–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–∞—è–∫–∞ —Å —É—á–µ—Ç–æ–º:
- ‚úÖ –ú–∞–≥–Ω–∏—Ç–Ω—ã—Ö –ø–æ–º–µ—Ö (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –î—Ä–∏—Ñ—Ç–∞ –≥–∏—Ä–æ—Å–∫–æ–ø–∞ (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è)
- ‚úÖ –¶–∏–∫–ª–∏—á–Ω–æ—Å—Ç–∏ –≥—Ä–µ–±–ª–∏ (—Å–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º)

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

```
üìä DMP –ö–≤–∞—Ç–µ—Ä–Ω–∏–æ–Ω—ã (–ì–∏—Ä–æ—Å–∫–æ–ø + –ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä)
   ‚Üì 95-98% –æ—Å–Ω–æ–≤–∞
   
üß≤ –ú–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥—Ä–∏—Ñ—Ç–∞)
   ‚Üì 0-5% –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∫–∞—á–µ—Å—Ç–≤–µ
   
üîÑ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≥—Ä–µ–±–ª–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
   ‚Üì 0-20% –ø—Ä–∏ –ø–æ–º–µ—Ö–∞—Ö –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞
   
   = –¢–æ—á–Ω–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
```

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

| –£—Å–ª–æ–≤–∏—è | DMP | –ú–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä | –ü–∞—Ç—Ç–µ—Ä–Ω—ã |
|---------|-----|-------------|----------|
| üü¢ –ú–∞–≥–Ω. –æ—Ç–ª–∏—á–Ω–æ | 95% | 5% | 0-5% |
| üü° –ú–∞–≥–Ω. —Ö–æ—Ä–æ—à–æ | 97% | 2.5% | 5-10% |
| üü† –ú–∞–≥–Ω. –ø–ª–æ—Ö–æ | 98% | 0% | 10-15% |
| üî¥ –ú–∞–≥–Ω. –Ω–µ–≤–µ—Ä–Ω–æ | 98% | 0% | 15-20% |

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞

- **–î–∏—Å–ø–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö** - –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –∏–∑–º–µ—Ä–µ–Ω–∏–π
- **–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π** - —Ä–µ–∑–∫–∏–µ —Å–∫–∞—á–∫–∏, –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º

### 3. –§–∞–∑—ã –≥—Ä–µ–±–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ

```
–§–∞–∑—ã:
CATCH ‚Üí DRIVE ‚Üí RELEASE ‚Üí RECOVERY ‚Üí (—Ü–∏–∫–ª)
```

–°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–∞–µ—Ç—Å—è:
- –î–∏–∞–ø–∞–∑–æ–Ω–∞–º —É–≥–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
- –î–∏–∞–ø–∞–∑–æ–Ω–∞–º —Å–∏–ª—ã
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ñ–∞–∑

–ü–æ—Å–ª–µ **5 –≥—Ä–µ–±–∫–æ–≤** ‚Üí –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 4. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥—Ä–∏—Ñ—Ç–∞

- **–û—Ü–µ–Ω–∫–∞ –¥—Ä–∏—Ñ—Ç–∞** –≤ —Ñ–∞–∑–µ RECOVERY (–≤–µ—Å–ª–æ –≤ –≤–æ–∑–¥—É—Ö–µ)
- **–ú–∞–ª–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** –ø–æ yaw
- **–ú–∞–≥–Ω–∏—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤ SmartKayak.h
```cpp
#include "PaddleOrientationFusion.h"

class SmartKayak {
    PaddleOrientationFusion orientationFusion;
    // ...
};
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
```cpp
SmartKayak::SmartKayak() {
    orientationFusion.setFilterWeights(0.97f, 0.03f, 0.0f);
    orientationFusion.setMagnetometerThresholds(500.0f, 100.0f);
}
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ update()
```cpp
void SmartKayak::update() {
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    IMUData kayakIMU, paddleIMU;
    OrientationData kayakOri, paddleOri;
    // ... –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ...
    
    // –ü–æ–ª—É—á–∞–µ–º —Ç–æ—á–Ω—É—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é
    SP_Math::Quaternion relQuat = orientationFusion.update(
        kayakIMU, paddleIMU, kayakOri, paddleOri, bladeForce
    );
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    float shaftRotation, shaftTilt, bladeRotation;
    getPaddleAngles(relQuat, shaftRotation, shaftTilt, bladeRotation);
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —É—Å–ª–æ–≤–∏—è

### –ß–∏—Å—Ç–∞—è –≤–æ–¥–∞ (–º–∞–ª–æ –ø–æ–º–µ—Ö)
```cpp
orientationFusion.setFilterWeights(0.95f, 0.05f, 0.0f);
orientationFusion.setMagnetometerThresholds(800.0f, 150.0f);
```

### –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
```cpp
orientationFusion.setFilterWeights(0.97f, 0.03f, 0.0f);
orientationFusion.setMagnetometerThresholds(500.0f, 100.0f);
```

### –°–∏–ª—å–Ω—ã–µ –ø–æ–º–µ—Ö–∏
```cpp
orientationFusion.setFilterWeights(0.98f, 0.01f, 0.0f);
orientationFusion.setMagnetometerThresholds(300.0f, 50.0f);
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```cpp
// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
int strokes;
bool learned;
float driftRate;
orientationFusion.getStats(strokes, learned, driftRate);

// –ö–∞—á–µ—Å—Ç–≤–æ –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞
MagnetometerQuality magQ = orientationFusion.getCurrentMagQuality(kayakIMU, paddleIMU);

// –§–∞–∑–∞ –≥—Ä–µ–±–∫–∞
StrokePhase phase = orientationFusion.getStrokePhase();

// –í—ã–≤–æ–¥
Serial.printf("–ì—Ä–µ–±–∫–æ–≤: %d | –û–±—É—á–µ–Ω–æ: %s | –î—Ä–∏—Ñ—Ç: %.3f¬∞/—Å | –ú–∞–≥–Ω: %d | –§–∞–∑–∞: %d\n",
    strokes, learned ? "–î–ê" : "–ù–ï–¢", driftRate, (int)magQ, (int)phase);
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ (–ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥)
- ‚ùå –î—Ä–∏—Ñ—Ç: ~5-10¬∞/–º–∏–Ω
- ‚ùå –ü—Ä–∏ –ø–æ–º–µ—Ö–∞—Ö: —Å–∫–∞—á–∫–∏ –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- ‚ùå –¢–æ—á–Ω–æ—Å—Ç—å: ¬±5-10¬∞

### –ü–æ—Å–ª–µ (Adaptive Fusion)
- ‚úÖ –î—Ä–∏—Ñ—Ç: <1¬∞/–º–∏–Ω
- ‚úÖ –ü—Ä–∏ –ø–æ–º–µ—Ö–∞—Ö: —Å—Ç–∞–±–∏–ª—å–Ω–æ (–ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- ‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å: ¬±1-3¬∞

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: `docs/PaddleOrientation_RU.md`
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `lib/SmartKayak/PaddleOrientationFusion_Integration.md`
- **–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞**: `examples/PaddleOrientationTest/`

## –ê–ª–≥–æ—Ä–∏—Ç–º –≤ –¥–µ—Ç–∞–ª—è—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```cpp
update(kayakIMU, paddleIMU, kayakOrientation, paddleOrientation, bladeForce)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞
1. **–ó–∞–≥—Ä—É–∑–∫–∞ DMP –∫–≤–∞—Ç–µ—Ä–Ω–∏–æ–Ω–æ–≤** (–æ—Å–Ω–æ–≤–∞ - –≥–∏—Ä–æ—Å–∫–æ–ø + –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä)
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞** (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∏–∑–º–µ—Ä–µ–Ω–∏–π)
3. **–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞** (–¥–∏—Å–ø–µ—Ä—Å–∏—è, –∞–Ω–æ–º–∞–ª–∏–∏)
4. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏** (–ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å)
5. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑—ã –≥—Ä–µ–±–∫–∞** (–ø–æ —É–≥–ª—É –∏ —Å–∏–ª–µ)
6. **–û–±—É—á–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤)
7. **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥—Ä–∏—Ñ—Ç–∞** (–æ—Ü–µ–Ω–∫–∞ + –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è)
8. **–ú–∞–≥–Ω–∏—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∫–∞—á–µ—Å—Ç–≤–µ)
9. **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É** (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤)
10. **–ö–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä (SLERP)** (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```cpp
‚Üí SP_Math::Quaternion relativeOrientation
```

## FAQ

### Q: –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä?
**A:** –ü–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–µ–π. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤–æ—Å—å–º–µ—Ä–∫–∏ –≤ –≤–æ–∑–¥—É—Ö–µ –≤–¥–∞–ª–∏ –æ—Ç –º–µ—Ç–∞–ª–ª–∞.

### Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω—É–∂–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º?
**A:** 5-10 –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –≥—Ä–µ–±–∫–æ–≤. –ò–∑–±–µ–≥–∞–π—Ç–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π –Ω–∞ —ç—Ç–∞–ø–µ –æ–±—É—á–µ–Ω–∏—è.

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∫–∞—á–µ—Å—Ç–≤–µ –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞?
**A:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ DMP + –ø–∞—Ç—Ç–µ—Ä–Ω—ã. –ù–æ –ª—É—á—à–µ –Ω–∞–π—Ç–∏ –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–º–µ—Ö.

### Q: –ö–æ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã?
**A:** –ü—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∏–ª—è –≥—Ä–µ–±–ª–∏, —Å–º–µ–Ω–µ –≤–µ—Å–ª–∞, —Ä–µ–∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –¥–∞—Ç—á–∏–∫–æ–≤:
```cpp
orientationFusion.resetPatterns();
```

### Q: –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ —Å–≤–æ–π —Å—Ç–∏–ª—å –≥—Ä–µ–±–ª–∏?
**A:** –õ–æ–≥–∏—Ä—É–π—Ç–µ —É–≥–ª—ã –∏ —Å–∏–ª—É, –∑–∞—Ç–µ–º –ø–æ–¥—Å—Ç—Ä–æ–π—Ç–µ –ø–æ—Ä–æ–≥–∏ –≤ `detectStrokePhase()`.

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ß–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ SmartKayak
